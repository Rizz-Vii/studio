{
    "alertPolicies": [
        {
            "displayName": "Firebase Functions - High Error Rate",
            "conditions": [
                {
                    "displayName": "Error rate > 5%",
                    "conditionThreshold": {
                        "filter": "resource.type=\"cloud_function\" AND metric.type=\"cloudfunctions.googleapis.com/function/execution_count\"",
                        "comparison": "COMPARISON_GREATER_THAN",
                        "thresholdValue": 0.05,
                        "duration": "300s",
                        "aggregations": [
                            {
                                "alignmentPeriod": "60s",
                                "perSeriesAligner": "ALIGN_RATE",
                                "crossSeriesReducer": "REDUCE_MEAN",
                                "groupByFields": [
                                    "resource.label.function_name"
                                ]
                            }
                        ]
                    }
                }
            ],
            "alertStrategy": {
                "autoClose": "1800s"
            },
            "combiner": "OR",
            "enabled": true,
            "severity": "ERROR"
        },
        {
            "displayName": "Firebase Functions - High Latency",
            "conditions": [
                {
                    "displayName": "95th percentile latency > 10s",
                    "conditionThreshold": {
                        "filter": "resource.type=\"cloud_function\" AND metric.type=\"cloudfunctions.googleapis.com/function/execution_times\"",
                        "comparison": "COMPARISON_GREATER_THAN",
                        "thresholdValue": 10000,
                        "duration": "300s",
                        "aggregations": [
                            {
                                "alignmentPeriod": "300s",
                                "perSeriesAligner": "ALIGN_DELTA",
                                "crossSeriesReducer": "REDUCE_PERCENTILE_95",
                                "groupByFields": [
                                    "resource.label.function_name"
                                ]
                            }
                        ]
                    }
                }
            ],
            "alertStrategy": {
                "autoClose": "1800s"
            },
            "combiner": "OR",
            "enabled": true,
            "severity": "WARNING"
        },
        {
            "displayName": "NeuroSEO Performance Functions - Memory Usage",
            "conditions": [
                {
                    "displayName": "Memory usage > 80%",
                    "conditionThreshold": {
                        "filter": "resource.type=\"cloud_function\" AND resource.label.function_name=~\"performance.*|realtimeMetrics|functionMetrics\" AND metric.type=\"cloudfunctions.googleapis.com/function/user_memory_bytes\"",
                        "comparison": "COMPARISON_GREATER_THAN",
                        "thresholdValue": 858993459.2,
                        "duration": "180s",
                        "aggregations": [
                            {
                                "alignmentPeriod": "60s",
                                "perSeriesAligner": "ALIGN_MEAN",
                                "crossSeriesReducer": "REDUCE_MAX",
                                "groupByFields": [
                                    "resource.label.function_name"
                                ]
                            }
                        ]
                    }
                }
            ],
            "alertStrategy": {
                "autoClose": "900s"
            },
            "combiner": "OR",
            "enabled": true,
            "severity": "WARNING"
        }
    ],
    "notificationChannels": [
        {
            "type": "email",
            "displayName": "RankPilot Performance Alerts",
            "description": "Email notifications for Firebase Functions performance issues",
            "labels": {
                "email_address": "performance-alerts@rankpilot.com"
            }
        }
    ]
}