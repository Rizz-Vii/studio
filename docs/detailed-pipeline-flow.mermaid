```mermaid
flowchart TD
    START([ğŸ”„ Push to feature/performance-*]) --> TRIGGER{ğŸ¯ CI/CD Pipeline Triggered}
    
    %% Stage 1: Performance Feature Validation
    TRIGGER --> S1[ğŸ“ˆ Stage 1: Performance Feature Validation<br/>â±ï¸ 5-7 minutes<br/>ğŸ§  Memory: 6144MB]
    
    S1 --> S1A[ğŸ“¦ Install Dependencies<br/>--legacy-peer-deps --prefer-offline]
    S1A --> S1B[ğŸ” Performance Linting<br/>ESLint + TypeScript validation]
    S1B --> S1C[ğŸ—ï¸ Build with Monitoring<br/>ANALYZE=true bundle analysis]
    S1C --> S1D[ğŸ“Š Bundle Size Analysis<br/>Webpack bundle analyzer]
    
    %% Parallel Execution Block
    S1D --> PARALLEL{ğŸ”„ Parallel Execution}
    
    %% Stage 2: Core Web Vitals Testing
    PARALLEL --> S2[ğŸ“Š Stage 2: Core Web Vitals Testing<br/>â±ï¸ 8-12 minutes<br/>ğŸ¯ 90% Threshold]
    S2 --> S2A[ğŸ—ï¸ Production Build<br/>Performance optimized]
    S2A --> S2B[ğŸš€ Start Dev Server<br/>localhost:3000 + 15s warmup]
    S2B --> S2C[ğŸŒ Lighthouse CI Audit<br/>90% threshold enforcement]
    S2C --> S2D[ğŸ“± Mobile Performance Testing<br/>Device emulation]
    S2D --> S2E[ğŸ“Š Metrics Analysis<br/>LCP/FID/CLS validation]
    S2E --> S2F{âŒ Score < 90%?}
    S2F -->|Yes| FAIL2[âŒ Performance Failure<br/>Pipeline Terminated]
    S2F -->|No| S2_PASS[âœ… Core Web Vitals Pass]
    
    %% Stage 3: Mobile Optimization Testing
    PARALLEL --> S3[ğŸ“± Stage 3: Mobile Optimization<br/>â±ï¸ 3-5 minutes<br/>ğŸ¯ WCAG 2.1 AA]
    S3 --> S3A[ğŸ—ï¸ Mobile Build<br/>Responsive compilation]
    S3A --> S3B[ğŸ“± Mobile-Specific Tests<br/>Touch interaction validation]
    S3B --> S3C[ğŸ¯ Touch Target Check<br/>48px minimum validation]
    S3C --> S3D[â™¿ Accessibility Tests<br/>WCAG 2.1 AA compliance]
    S3D --> S3E{ğŸš« WCAG Fail?}
    S3E -->|Yes| FAIL3[âŒ Accessibility Failure<br/>Pipeline Terminated]
    S3E -->|No| S3_PASS[âœ… Mobile Optimization Pass]
    
    %% Stage 5: Security & Performance Audit (Parallel)
    PARALLEL --> S5[ğŸ”’ Stage 5: Security Audit<br/>â±ï¸ 3-5 minutes<br/>ğŸ›¡ï¸ Performance Security]
    S5 --> S5A[ğŸ” npm Security Audit<br/>Moderate+ vulnerabilities]
    S5A --> S5B[ğŸ›¡ï¸ Performance Security Check<br/>Configuration validation]
    S5B --> S5C[ğŸ” Environment Validation<br/>Secrets and configs]
    S5C --> S5D{ğŸš¨ Security Issues?}
    S5D -->|Yes| FAIL5[âŒ Security Failure<br/>Pipeline Terminated]
    S5D -->|No| S5_PASS[âœ… Security Audit Pass]
    
    %% Stage 4: Enhanced Testing Suite
    S2_PASS --> S4[ğŸ§ª Stage 4: Enhanced Testing<br/>â±ï¸ 10-15 minutes<br/>ğŸ”„ Matrix Strategy]
    S3_PASS --> S4
    
    S4 --> S4A[ğŸ”¥ Critical Path Tests<br/>Essential functionality]
    S4 --> S4B[ğŸ§  High-Memory Tests<br/>6144MB AI components]
    S4 --> S4C[ğŸš€ Warmed Cache Tests<br/>Production simulation]
    
    S4A --> S4_SYNC[âš¡ Matrix Sync Point]
    S4B --> S4_SYNC
    S4C --> S4_SYNC
    
    S4_SYNC --> S4D{ğŸ§ª Any Test Failures?}
    S4D -->|Yes| FAIL4[âŒ Test Suite Failure<br/>Pipeline Terminated]
    S4D -->|No| S4_PASS[âœ… Enhanced Testing Pass]
    
    %% Stage 6: Merge Readiness Check
    S4_PASS --> S6[âœ… Stage 6: Merge Readiness<br/>â±ï¸ 2-3 minutes<br/>ğŸ¯ Quality Gates]
    S5_PASS --> S6
    
    S6 --> S6A[ğŸ—ï¸ Final Build Validation<br/>Production build test]
    S6A --> S6B[ğŸ“Š Performance Metrics Report<br/>Comprehensive summary]
    S6B --> S6C[âœ… Quality Gate Summary<br/>All stages validation]
    S6C --> S6D{ğŸš« Quality Gate Fail?}
    S6D -->|Yes| FAIL6[âŒ Readiness Failure<br/>Pipeline Terminated]
    S6D -->|No| S6_PASS[âœ… Merge Readiness Pass]
    
    %% Stage 7: Auto-Merge & Deploy
    S6_PASS --> S7[ğŸ”„ Stage 7: Auto-Deploy<br/>â±ï¸ 3-5 minutes<br/>ğŸŒ Live Channel]
    
    S7 --> S7A[ğŸŒ Preview Channel Deploy<br/>performance-testing channel]
    S7A --> S7B[ğŸ“Š Live Channel Testing<br/>Real Firebase validation]
    S7B --> S7C[ğŸ”„ Auto-Merge to preDeploy<br/>Fast-forward merge]
    S7C --> S7D[ğŸ“¢ Success Notification<br/>Pipeline completion]
    
    S7D --> SUCCESS[ğŸ‰ Pipeline Success!<br/>ğŸ”— Live: rankpilot-h3jpc--performance-testing-mw0cwov5.web.app<br/>â¡ï¸ Triggers Stage 2: preDeploy Pipeline]
    
    %% Failure Collection
    FAIL2 --> STOP[ğŸ›‘ Pipeline Stopped<br/>Review & Fix Required]
    FAIL3 --> STOP
    FAIL4 --> STOP
    FAIL5 --> STOP
    FAIL6 --> STOP
    
    %% Styling
    classDef stage fill:#e3f2fd,stroke:#1976d2,stroke-width:3px,color:#000
    classDef parallel fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000
    classDef task fill:#fff8e1,stroke:#f57c00,stroke-width:1px,color:#000
    classDef decision fill:#fff3e0,stroke:#ef6c00,stroke-width:2px,color:#000
    classDef success fill:#e8f5e8,stroke:#388e3c,stroke-width:3px,color:#000
    classDef failure fill:#ffebee,stroke:#d32f2f,stroke-width:3px,color:#000
    classDef stop fill:#fce4ec,stroke:#ad1457,stroke-width:2px,color:#000
    
    class S1,S2,S3,S4,S5,S6,S7 stage
    class PARALLEL parallel
    class S1A,S1B,S1C,S1D,S2A,S2B,S2C,S2D,S2E,S3A,S3B,S3C,S3D,S4A,S4B,S4C,S5A,S5B,S5C,S6A,S6B,S6C,S7A,S7B,S7C,S7D,S2_PASS,S3_PASS,S4_PASS,S5_PASS,S6_PASS,S4_SYNC task
    class S2F,S3E,S4D,S5D,S6D,TRIGGER decision
    class SUCCESS success
    class FAIL2,FAIL3,FAIL4,FAIL5,FAIL6 failure
    class STOP stop
```
